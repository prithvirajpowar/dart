pipeline {
  agent any

  stages {
    stage('Clone repository') {
      steps {
        git branch: 'main', url: 'https://github.com/prithvirajpowar/dart.git'
      }
    }

    stage('Build hello.dart') {
      when {
        branch 'main'
      }
      steps {
        sh 'dart2native hello.dart -o hello'
      }
    }

    stage('Build name.dart') {
      when {
        branch 'dart'
      }
      steps {
        sh 'dart2native name.dart -o name'
      }
    }

    stage('Test hello.dart') {
      when {
        branch 'main'
      }
      steps {
        sh './hello'
        // Add tests for hello.dart here
      }
    }

    stage('Test name.dart') {
      when {
        branch 'dart'
      }
      steps {
        sh './name'
        // Add tests for name.dart here
      }
    }
  }
}
